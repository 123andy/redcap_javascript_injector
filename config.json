{
    "name": "REDCap JavaScript Injector",
    "namespace": "DE\\RUB\\JSInjectorExternalModule",
    "description": "Allow project admins to inject JavaScript code into surveys and data entry pages. <strong><a href=\"https://github.com/grezniczek/redcap-javascript-injector\">See full documentation here</a></strong>.",
    "permissions": [
        "redcap_data_entry_form_top",
        "redcap_survey_page_top",
        "redcap_project_home_page",
        "redcap_every_page_top"
    ],
    "framework-version": 9,
    "enable-every-page-hooks-on-system-pages": true,
    "authors": [
        {
            "name": "Günther Rezniczek",
            "email": "guenther.rezniczek@rub.de",
            "institution": "Ruhr-Universität Bochum"
        }
    ],
    "system-settings": [
        {
            "name": "<b>Allow only super-users to configure this module in projects</b>",
            "key": "su_only",
            "type": "checkbox"
        },
        {
            "name": "<b>Enable system-defined JavaScript injections:</b><br><i>Attention:</i> Note that for any injections targeted at project contexts, these will only work if this module is enabled in the projects. To achieve this without exposing this module's project configuration too widely, it is recommended to turn on <b>Enable module on all projects by default</b> and <b>Hide this module from non-admins in the list of enabled modules on each project</b> (and then enable visibility in the projects where the module should be exposed)",
            "key": "sys-injections",
            "type": "checkbox"
        },
        {
            "name": "<b>Provide an instance of the JavascriptModuleObject:</b><br>When enabled, a JavascriptModuleObject will be instantiated and then can be used in JS snippets. The JavascriptModuleObject is accessible at <i>#JSMO#</i>",
            "key": "sys-jsmo",
            "type": "checkbox"
        },
        {
            "name": "JS Code",
            "key": "sys-js",
            "type": "sub_settings",
            "repeatable": true,
            "branchingLogic": {
                "field": "sys-injections",
                "value": true
            },
            "sub_settings": [
                {
                    "name": "<b>Enabled in system contexts:</b><br>Limit to these scopes",
                    "key": "sys-js_enabled_system",
                    "type": "checkbox"
                },
                {
                    "name": "All system pages",
                    "key": "sys-context_all",
                    "type": "checkbox"
                },
                {
                    "name": "Control Center",
                    "key": "sys-context_cc",
                    "type": "dropdown",
                    "choices": [
                        {
                            "value": "",
                            "name": "Not set (on if all is on)"
                        },
                        {
                            "value": "include",
                            "name": "Always on"
                        },
                        {
                            "value": "exclude",
                            "name": "Always off"
                        }
                    ]
                },
                {
                    "name": "Browse Projects",
                    "key": "sys-context_browseprojects",
                    "type": "dropdown",
                    "choices": [
                        {
                            "value": "",
                            "name": "Not set (on if all is on)"
                        },
                        {
                            "value": "include",
                            "name": "Always on"
                        },
                        {
                            "value": "exclude",
                            "name": "Always off"
                        }
                    ]                },
                {
                    "name": "Browse Users",
                    "key": "sys-context_browseusers",
                    "type": "dropdown",
                    "choices": [
                        {
                            "value": "",
                            "name": "Not set (on if all is on)"
                        },
                        {
                            "value": "include",
                            "name": "Always on"
                        },
                        {
                            "value": "exclude",
                            "name": "Always off"
                        }
                    ]                },
                {
                    "name": "Edit user info",
                    "key": "sys-context_edituser",
                    "type": "dropdown",
                    "choices": [
                        {
                            "value": "",
                            "name": "Not set (on if all is on)"
                        },
                        {
                            "value": "include",
                            "name": "Always on"
                        },
                        {
                            "value": "exclude",
                            "name": "Always off"
                        }
                    ]                },
                {
                    "name": "Email Users",
                    "key": "sys-context_emailusers",
                    "type": "dropdown",
                    "choices": [
                        {
                            "value": "",
                            "name": "Not set (on if all is on)"
                        },
                        {
                            "value": "include",
                            "name": "Always on"
                        },
                        {
                            "value": "exclude",
                            "name": "Always off"
                        }
                    ]
                },
                {
                    "name": "<b>Enabled in project contexts:</b><br>Limit to these project pages",
                    "key": "sys-js_enabled_projects",
                    "type": "checkbox"
                },
                {
                    "name": "All project pages",
                    "key": "proj-context_all",
                    "type": "dropdown",
                    "choices": [
                        {
                            "value": "",
                            "name": "Not set (on if all is on)"
                        },
                        {
                            "value": "include",
                            "name": "Always on"
                        },
                        {
                            "value": "exclude",
                            "name": "Always off"
                        }
                    ]                },
                {
                    "name": "Project Home Page",
                    "key": "proj-context_php",
                    "type": "dropdown",
                    "choices": [
                        {
                            "value": "",
                            "name": "Not set (on if all is on)"
                        },
                        {
                            "value": "include",
                            "name": "Always on"
                        },
                        {
                            "value": "exclude",
                            "name": "Always off"
                        }
                    ]                },
                {
                    "name": "Record Status Dashboard",
                    "key": "proj-context_rsd",
                    "type": "dropdown",
                    "choices": [
                        {
                            "value": "",
                            "name": "Not set (on if all is on)"
                        },
                        {
                            "value": "include",
                            "name": "Always on"
                        },
                        {
                            "value": "exclude",
                            "name": "Always off"
                        }
                    ]                },
                {
                    "name": "Add / Edit Records",
                    "key": "proj-context_aer",
                    "type": "dropdown",
                    "choices": [
                        {
                            "value": "",
                            "name": "Not set (on if all is on)"
                        },
                        {
                            "value": "include",
                            "name": "Always on"
                        },
                        {
                            "value": "exclude",
                            "name": "Always off"
                        }
                    ]                },
                {
                    "name": "Record Home Page",
                    "key": "proj-context_rhp",
                    "type": "dropdown",
                    "choices": [
                        {
                            "value": "",
                            "name": "Not set (on if all is on)"
                        },
                        {
                            "value": "include",
                            "name": "Always on"
                        },
                        {
                            "value": "exclude",
                            "name": "Always off"
                        }
                    ]                },
                {
                    "name": "Data Entry Pages",
                    "key": "proj-context_data_entry",
                    "type": "dropdown",
                    "choices": [
                        {
                            "value": "",
                            "name": "Not set (on if all is on)"
                        },
                        {
                            "value": "include",
                            "name": "Always on"
                        },
                        {
                            "value": "exclude",
                            "name": "Always off"
                        }
                    ]                },
                {
                    "name": "Surveys",
                    "key": "proj-context_survey",
                    "type": "dropdown",
                    "choices": [
                        {
                            "value": "",
                            "name": "Not set (on if all is on)"
                        },
                        {
                            "value": "include",
                            "name": "Always on"
                        },
                        {
                            "value": "exclude",
                            "name": "Always off"
                        }
                    ]                },
                {
                    "name": "Reports",
                    "key": "proj-context_report",
                    "type": "dropdown",
                    "choices": [
                        {
                            "value": "",
                            "name": "Not set (on if all is on)"
                        },
                        {
                            "value": "include",
                            "name": "Always on"
                        },
                        {
                            "value": "exclude",
                            "name": "Always off"
                        }
                    ]                },
                {
                    "name": "Project Dashboards (authenticated)",
                    "key": "proj-context_db",
                    "type": "dropdown",
                    "choices": [
                        {
                            "value": "",
                            "name": "Not set (on if all is on)"
                        },
                        {
                            "value": "include",
                            "name": "Always on"
                        },
                        {
                            "value": "exclude",
                            "name": "Always off"
                        }
                    ]
                },
                {
                    "name": "Project Dashboards (public)",
                    "key": "proj-context_dbp",
                    "type": "dropdown",
                    "choices": [
                        {
                            "value": "",
                            "name": "Not set (on if all is on)"
                        },
                        {
                            "value": "include",
                            "name": "Always on"
                        },
                        {
                            "value": "exclude",
                            "name": "Always off"
                        }
                    ]                },
                {
                    "name": "JavaScript Snippet (without &lt;script&gt; tags)",
                    "key": "sys-js_code",
                    "required": true,
                    "type": "textarea"
                }
            ]
        }
    ],
    "project-settings": [
        {
            "name": "<b>Provide an instance of the JavascriptModuleObject:</b><br>When enabled, a JavascriptModuleObject will be instantiated and then can be used in JS snippets. The JavascriptModuleObject is accessible at <i>#JSMO#</i>",
            "key": "proj-jsmo",
            "type": "checkbox"
        },
        {
            "name": "JS Code",
            "key": "js",
            "type": "sub_settings",
            "repeatable": true,
            "sub_settings": [
                {
                    "name": "Enabled",
                    "key": "js_enabled",
                    "type": "checkbox"
                },
                {
                    "name": "Apply to",
                    "key": "js_type",
                    "type": "radio",
                    "required": true,
                    "choices": [
                        {
                            "value": "php",
                            "name": "Project Home Page"
                        },
                        {
                            "value": "rsd",
                            "name": "Record Status Dashboard"
                        },
                        {
                            "value": "aer",
                            "name": "Add / Edit Records"
                        },
                        {
                            "value": "rhp",
                            "name": "Record Home Page"
                        },
                        {
                            "value": "survey",
                            "name": "Surveys"
                        },
                        {
                            "value": "data_entry",
                            "name": "Data Entry Pages"
                        },
                        {
                            "value": "survey,data_entry",
                            "name": "Both, Surveys and Data Entry Pages"
                        },
                        {
                            "value": "report",
                            "name": "Reports"
                        },
                        {
                            "value": "db",
                            "name": "Project Dashboards (authenticated)"
                        },
                        {
                            "value": "dbp",
                            "name": "Project Dashboards (public)"
                        },
                        {
                            "value": "all",
                            "name": "All project pages"
                        }
                    ]
                },
                {
                    "name": "Apply to the following instruments (leave blank to apply to all instruments)",
                    "key": "js_instruments",
                    "type": "form-list",
                    "repeatable": true,
                    "select2": true
                },
                {
                    "name": "JavaScript Snippet (without &lt;script&gt; tags)",
                    "key": "js_code",
                    "required": true,
                    "type": "textarea"
                }
            ]
        }
    ],
    "compatibility": {
        "php-version-min": "7.4.0",
        "php-version-max": "",
        "redcap-version-min": "12.2.10",
        "redcap-version-max": ""
     }
}